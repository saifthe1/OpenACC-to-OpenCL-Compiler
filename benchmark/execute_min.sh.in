#!/bin/bash

source @abs_srcdir@/config.rc

rm -rf $1

@abs_top_srcdir@/db-tools/init_min_db $1

for test in $TEST
do
  cd $test

  for t0 in $TILE_0
  do
    for t1 in $TILE_1
    do
      for t2 in $TILE_2
      do
        if isValidTiling $t0 $t1 $t2
        then
          cd $t0-$t1-$t2

          for gang in $GANG
          do
            for worker in $WORKER
            do
              for vector in $VECTOR
              do
                for size in 128
                do
                  for rep in `seq 1 $REP`
                  do
                    ./eval-min ../../$1 "test" $gang $worker $vector $(($size * 1024 * 1024))
                  done
                done
              done
            done
          done

          cd ..
        fi
      done
    done
  done
  cd ..
done

